<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D Neon Dice</title>
    <style>
        body { margin: 0; overflow: hidden; font-family: 'Segoe UI', sans-serif; }
        canvas { display: block; }
        
        #ui {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            pointer-events: none;
            z-index: 10;
        }

        #result {
            font-size: 120px;
            font-weight: 900;
            color: white;
            text-shadow: 0 0 20px rgba(0,0,0,0.5), 0 0 40px rgba(255,255,255,0.8);
            opacity: 0;
            transition: transform 0.3s ease-out, opacity 0.2s;
            transform: scale(0.5);
        }

        #instruction {
            position: absolute;
            bottom: 30px;
            width: 100%;
            text-align: center;
            color: rgba(255,255,255,0.7);
            text-transform: uppercase;
            letter-spacing: 2px;
            pointer-events: none;
        }
    </style>
</head>
<body>

<div id="ui">
    <div id="result">?</div>
</div>
<div id="instruction">Натисніть на куб</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>

<script>
    let scene, camera, renderer, cube;
    let isRolling = false;
    const resultEl = document.getElementById('result');

    function init() {
        // 1. Сцена та Камера
        scene = new THREE.Scene();
        camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.z = 5;

        // 2. Рендерер (Графіка)
        renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.body.appendChild(renderer.domElement);

        // 3. Куб
        const geometry = new THREE.BoxGeometry(2, 2, 2);
        // Створюємо градієнтний матеріал для граней
        const material = new THREE.MeshPhongMaterial({ 
            color: 0xffffff,
            shininess: 100,
            reflectivity: 1
        });
        cube = new THREE.Mesh(geometry, material);
        scene.add(cube);

        // 4. Освітлення
        const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
        scene.add(ambientLight);

        const pointLight = new THREE.PointLight(0xffffff, 1);
        pointLight.position.set(5, 5, 5);
        scene.add(pointLight);

        // 5. Фон (Анімований градієнт)
        animateBackground();

        // Події
        window.addEventListener('mousedown', rollDice);
        window.addEventListener('touchstart', rollDice);
        window.addEventListener('resize', onWindowResize);

        animate();
    }

    function animateBackground() {
        // Плавна зміна кольору фону: Фіолетовий <-> Жовтий
        gsap.to('body', {
            backgroundColor: "#ffff00", // жовтий
            duration: 5,
            repeat: -1,
            yoyo: true,
            ease: "sine.inOut",
            onUpdate: function() {
                const color = window.getComputedStyle(document.body).backgroundColor;
                // Синхронізуємо колір куба або світла за бажанням
            }
        });
        document.body.style.backgroundColor = "#8000ff"; // старт з фіолетового
    }

    function rollDice() {
        if (isRolling) {
            // Якщо цифра вже є, при натисканні приховуємо її
            gsap.to(resultEl, { opacity: 0, scale: 0.5, duration: 0.2 });
            isRolling = false;
            return;
        }

        isRolling = true;
        const result = Math.floor(Math.random() * 6) + 1;

        // Анімація куба: Стрибок та Обертання
        gsap.to(cube.rotation, {
            x: cube.rotation.x + Math.PI * 4,
            y: cube.rotation.y + Math.PI * 4,
            duration: 0.8,
            ease: "power2.out"
        });

        gsap.to(cube.position, {
            y: 1.5,
            duration: 0.4,
            yoyo: true,
            repeat: 1,
            ease: "power2.out",
            onComplete: () => {
                // Показуємо результат після стрибка
                resultEl.innerText = result;
                gsap.to(resultEl, { 
                    opacity: 1, 
                    scale: 1.2, 
                    duration: 0.4, 
                    ease: "back.out(1.7)" 
                });
            }
        });
    }

    function onWindowResize() {
        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();
        renderer.setSize(window.innerWidth, window.innerHeight);
    }

    function animate() {
        requestAnimationFrame(animate);
        
        // Легке постійне обертання куба для "3D ефекту"
        if (!isRolling) {
            cube.rotation.x += 0.01;
            cube.rotation.y += 0.01;
        }

        renderer.render(scene, camera);
    }

    init();
</script>
</body>
</html>
